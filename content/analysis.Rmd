---
title: Analysis
description:
toc: true
featuredVideo:
featuredImage: images/analysis_page.jpg
draft: false
---

This comes from the file `content/analysis.Rmd`.

We describe here our detailed data analysis.


```{r}
suppressPackagestartupMessages(library(tidyverse))
print(getwd())
data <- read_csv(here::here("dataset/loan_refusal_clean.csv"))
load(here::here("dataset/loan_refusal.RData"))
print(ls())
```

## Note on Attribution

If you are directly quoting from a source, please make that clear. You can show quotes using `>` like this

```
> To be or not to be.
```

> To be or not to be.

Also, make sure to provide a link or citation to where you are quoting from.

-------


## Rubric: On this page

you will


* Introduce what motivates your Data Analysis (DA)
  * Which variables and relationships are you most interested in?
  * What questions are you interested in answering?
* Breadth of the DA
  * Make sure that you ask enough initial questions to explore the different variables in your data.
  * i.e. Do you explore more than just one or two variables? Do you explore a few different relationships or many?
* Depth of the DA
  * When you answer one question, usually more questions arise as well. 
  * The depth of the DA is about coming up with and exploring the answers to these questions, often iterating the process a few times.
* Modeling and Inference 
  * You should also include some kind of formal statistical model and/or inference. This could be a linear regression, logistic regression, hypothesis testing etc.
  * Explain the techniques you used for validating your results.
  * Describe the results of your modelling and make sure to give a sense of the uncertainty in your estimates and conclusions.
* Explain the flaws and limitations of your analysis
  * Are there some assumptions that you needed to make that might not hold? Is there other data that would help to answer your questions? ...
* Clarity Figures
  * Are your figures/tables/results easy to read, informative, without problems like overplotting, hard-to-read labels, etc?
  * Each figure should provide a key insight. Too many figures or other data summaries can detract from this.
* Clarity of Explanations
  * Do you introduce why you are doing each analysis?
  * How well do you explain each figure/result?
  * Do you provide interpretations that suggest further analysis or explanations for observed phenomenon?
* Organization and cleanliness.
  * Make sure to remove excessive warnings, use clean easy-to-read code, organize with sections or multiple pages, use bullets, etc.
  
  
**NOTE**: Your Data Analysis can be broken up into multiple pages if that helps with your organization.




```{r maysen_modeling}
load(here::here("dataset", "win_perc.RData"))
load(here::here("dataset", "mlb_payroll.RData"))
load(here::here("dataset", "baseball.RData"))

payroll_win <- win_perc %>% left_join(mlb_payroll, by = c("year", "h_name")) %>% f
ilter(!is.na(payroll))

(payroll_mod <- lm(win_perc ~ log(payroll), data = payroll_win))
beta <- coef(payroll_mod)

# for all teams, as payroll increases, winning percentage for a given year increases
ggplot(payroll_win) + geom_point(aes(log(payroll), win_perc)) + 
  geom_abline(intercept = beta[1], slope = beta[2], color = "red")

#Pittsburgh pirates are a team who match this overall pattern
pit <- payroll_win %>% filter(h_name == "PIT")
pit_mod <- lm(win_perc~log(payroll), data = pit)
pit_beta <- coef(pit_mod)
ggplot(pit) + geom_point(aes(log(payroll), win_perc)) + 
  geom_abline(intercept = pit_beta[1], slope = pit_beta[2], color = "red")

#find year payroll was lowest and highest for Pittsburgh
mlb_payroll %>% filter(h_name == "PIT") %>% arrange(payroll)
#2000 lowest 2015 highest

bb <- baseball %>% mutate(win_loss = ifelse(score_diff>1, 1, 0))

#home games - each starting pitcher's prop of games winning of games started
#2000
bb %>% filter(h_name == "PIT", year == 2000) %>% 
  group_by(h_starting_pitcher_name) %>%
  summarize(games_started = n(), 
            games_won = sum(h_starting_pitcher_name==winning_pitcher_name), 
            prop = games_won/games_started) %>% 
  arrange(desc(games_started)) %>%
  ggplot(aes(games_started, prop)) + 
  geom_point(aes(color = h_starting_pitcher_name))
#2015
bb %>% filter(h_name == "PIT", year == 2015) %>% 
  group_by(h_starting_pitcher_name) %>%
  summarize(games_started = n(), 
            games_won = sum(h_starting_pitcher_name==winning_pitcher_name), 
            prop = games_won/games_started) %>% 
  arrange(desc(games_started)) %>%
  ggplot(aes(games_started, prop)) + 
  geom_point(aes(color = h_starting_pitcher_name))

#away games - each starting pitcher's prop of games winning of games started
#2000
bb %>% filter(v_name == "PIT", year == 2000) %>% 
  group_by(v_starting_pitcher_name) %>%
  summarize(games_started = n(), 
            games_won = sum(v_starting_pitcher_name==winning_pitcher_name), 
            prop = games_won/games_started) %>% 
  arrange(desc(games_started)) %>%
  ggplot(aes(games_started, prop)) + 
  geom_point(aes(color = v_starting_pitcher_name))

#2015
bb %>% filter(v_name == "PIT", year == 2015) %>% 
  group_by(v_starting_pitcher_name) %>%
  summarize(games_started = n(), 
            games_won = sum(v_starting_pitcher_name==winning_pitcher_name), 
            prop = games_won/games_started) %>% 
  arrange(desc(games_started)) %>%
  ggplot(aes(games_started, prop)) + 
  geom_point(aes(color = v_starting_pitcher_name))


# for chicago white sox, as payroll increases, winning percentage decreases
cha <- payroll_win %>% filter(h_name == "CHA")
cha_mod <- lm(win_perc~log(payroll), data = cha)
cha_beta <- coef(cha_mod)
ggplot(cha) + geom_point(aes(log(payroll), win_perc)) + 
  geom_abline(intercept = cha_beta[1], slope = cha_beta[2], color = "red")

#find year payroll was lowest and highest for chicago
mlb_payroll %>% filter(h_name == "CHA") %>% arrange(payroll)
#2000 lowest 2011 highest

#home games - each starting pitcher's prop of games winning of games started
#2000
bb %>% filter(h_name == "CHA", year == 2000) %>% 
  group_by(h_starting_pitcher_name) %>%
  summarize(games_started = n(), 
            games_won = sum(h_starting_pitcher_name==winning_pitcher_name), 
            prop = games_won/games_started) %>% 
  arrange(desc(games_started)) %>%
  ggplot(aes(games_started, prop)) + 
  geom_point(aes(color = h_starting_pitcher_name))

#2011
bb %>% filter(h_name == "CHA", year == 2011) %>% 
  group_by(h_starting_pitcher_name) %>%
  summarize(games_started = n(), 
            games_won = sum(h_starting_pitcher_name==winning_pitcher_name), 
            prop = games_won/games_started) %>% 
  arrange(desc(games_started)) %>%
  ggplot(aes(games_started, prop)) + 
  geom_point(aes(color = h_starting_pitcher_name))

#away games - each starting pitcher's prop of games winning of games started
#2000
bb %>% filter(v_name == "CHA", year == 2000) %>% 
  group_by(v_starting_pitcher_name) %>%
  summarize(games_started = n(), 
            games_won = sum(v_starting_pitcher_name==winning_pitcher_name), 
            prop = games_won/games_started) %>% 
  arrange(desc(games_started)) %>%
  ggplot(aes(games_started, prop)) + 
  geom_point(aes(color = v_starting_pitcher_name))

#2011
bb %>% filter(v_name == "CHA", year == 2011) %>% 
  group_by(v_starting_pitcher_name) %>%
  summarize(games_started = n(), 
            games_won = sum(v_starting_pitcher_name==winning_pitcher_name), 
            prop = games_won/games_started) %>% 
  arrange(desc(games_started)) %>%
  ggplot(aes(games_started, prop)) + 
  geom_point(aes(color = v_starting_pitcher_name))
```